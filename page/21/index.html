<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Lavine Hu</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Lavine Hu"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lavine Hu"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Lavine Hu"><meta property="og:url" content="https://github.com/hlw95?tab=following"><meta property="og:site_name" content="Lavine Hu"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><meta property="article:author" content="Lavine Hu"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Lavine Hu","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Lavine Hu"},"description":""}</script><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Lavine Hu</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/message">留言</a></div><div class="navbar-end"><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-02-04  <a class="commentCountImg" href="/2022/02/04/Azkaban/#comment-container"><span class="display-none-class">0714dea3b81ce6a5514acab096ecc7b6</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="0714dea3b81ce6a5514acab096ecc7b6">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>3 m  <i class="fas fa-pencil-alt"> </i>0.5 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/04/Azkaban/">Azkaban</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wtzhm/article/details/89220508">https://blog.csdn.net/wtzhm/article/details/89220508</a></p>
<h2 id="1-为什么需要工作流调度系统"><a href="#1-为什么需要工作流调度系统" class="headerlink" title="1 为什么需要工作流调度系统"></a>1 为什么需要工作流调度系统</h2><p>1）一个完整的数据分析系统通常都是由大量任务单元组成：Shell脚本程序，Java程序，MapReduce程序、Hive脚本等</p>
<p>2）各任务单元之间存在时间先后及前后依赖关系</p>
<p>3）为了很好地组织起这样的复杂执行计划，需要一个工作流调度系统来调度执行</p>
<p><img src="/2022/02/04/Azkaban/1.JPG" alt></p>
<h2 id="2-常见工作流调度系统"><a href="#2-常见工作流调度系统" class="headerlink" title="2 常见工作流调度系统"></a>2 常见工作流调度系统</h2><p>1）简单的任务调度</p>
<p>直接使用Linux的Crontab来定义；</p>
<p>2）复杂的任务调度</p>
<p>开发调度平台或使用现成的开源调度系统，比如Ooize、Azkaban、 Airflow、DolphinScheduler等。</p>
<p>3）Azkaban</p>
<p>Azkaban is a batch workflow job scheduler created at LinkedIn to run Hadoop jobs. Azkaban resolves the ordering through job dependencies and provides an easy to use web user interface to maintain and track your workflows.</p>
<p>Azkaban是一个开源的任务调度系统，用于负责任务的调度运行（如数据仓库调度），用以替代linux中的crontab。</p>
<p>和Oozie对比</p>
<p>总体来说，Ooize相比Azkaban是一个重量级的任务调度系统，功能全面，但配置使用也更复杂。如果可以不在意某些功能的缺失，轻量级调度器Azkaban是很不错的候选对象。</p>
<h2 id="3-使用"><a href="#3-使用" class="headerlink" title="3 使用"></a>3 使用</h2><p><img src="/2022/02/04/Azkaban/2.JPG" alt></p>
<h3 id="1-使用流程"><a href="#1-使用流程" class="headerlink" title="1 使用流程"></a>1 使用流程</h3><p>1.数据准备</p>
<p>2.编写Azkaban工作流程配置文件</p>
<p>​    a.编写azkaban.project</p>
<p>​    b.编写gmall.flow文件</p>
<h3 id="2-多Executor模式下注意事项"><a href="#2-多Executor模式下注意事项" class="headerlink" title="2 多Executor模式下注意事项"></a>2 多Executor模式下注意事项</h3><p>方案一：指定特定的Executor（hadoop102）去执行任务。</p>
<p>​    a.在MySQL中azkaban数据库executors表中，查询hadoop102上的Executor的id。</p>
<p>​    b.在执行工作流程时加入useExecutor属性</p>
<p>方案二：在Executor所在所有节点部署任务所需脚本和应用。</p>
<p>推荐使用方案二</p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/Azkaban/">Azkaban</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/Azkaban/">Azkaban</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-02-03  <a class="commentCountImg" href="/2022/02/03/build-datawarehouse/#comment-container"><span class="display-none-class">87bdc75ab7bcbfba1bc99f486c24642a</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="87bdc75ab7bcbfba1bc99f486c24642a">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>11 m  <i class="fas fa-pencil-alt"> </i>1.6 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/03/build-datawarehouse/">离线数仓搭建例子(电商为例)</a></h1><div class="content"><h2 id="0-架构"><a href="#0-架构" class="headerlink" title="0 架构"></a>0 架构</h2><p><img src="/2022/02/03/build-datawarehouse/121.JPG" alt></p>
<h2 id="1-数据来源"><a href="#1-数据来源" class="headerlink" title="1.数据来源"></a>1.数据来源</h2><h3 id="1-1-用户行为数据"><a href="#1-1-用户行为数据" class="headerlink" title="1.1 用户行为数据"></a>1.1 用户行为数据</h3><p>用户在使用产品过程中，通过埋点收集与客户端产品交互过程中产生的数据，并发往日志服务器进行保存。比如页面浏览、点击、停留、评论、点赞、收藏等。用户行为数据通常存储在日志文件中。</p>
<p>我们的日志结构大致可分为两类，<strong>一是普通页面埋点日志，二是启动日志。</strong></p>
<p>普通页面日志结构如下，每条日志包含了，当前页面的页面信息，所有事件（动作）、所有曝光信息以及错误信息。除此之外，还包含了一系列公共信息，包括设备信息，地理位置，应用信息等，即下边的common字段。</p>
<p>启动日志结构相对简单，主要包含公共信息，启动信息和错误信息。</p>
<h3 id="1-2-业务数据"><a href="#1-2-业务数据" class="headerlink" title="1.2 业务数据"></a>1.2 业务数据</h3><p>就是各行业在处理事务过程中产生的数据。比如用户在电商网站中登录、下单、支付等过程中，需要和网站后台数据库进行增删改查交互，产生的数据就是业务数据<strong>。</strong>业务数据通常存储在MySQL、Oracle等数据库中。</p>
<p>总共47张表，选了27张业务表</p>
<h2 id="2-数据采集"><a href="#2-数据采集" class="headerlink" title="2 数据采集"></a>2 数据采集</h2><p>1 用户行为数据</p>
<p>jar-》log（日志服务器）-》flume-》kafka-》flume-》hdfs</p>
<p>2 业务数据</p>
<p>jar-》mysql-》sqoop-》hdfs</p>
<h2 id="3-ODS"><a href="#3-ODS" class="headerlink" title="3.ODS"></a>3.ODS</h2><p>hdfs（ori）-》hdfs（ods）</p>
<h4 id="1-用户行为数据"><a href="#1-用户行为数据" class="headerlink" title="1 用户行为数据"></a>1 用户行为数据</h4><p>1张表，topic_log -&gt; ods_log</p>
<p>a.建表</p>
<p>就一个字段”line“</p>
<p>b 分区</p>
<p>首日，每日都是全量</p>
<p>c .数据装载</p>
<h4 id="2-业务数据"><a href="#2-业务数据" class="headerlink" title="2 业务数据"></a>2 业务数据</h4><p>27张表</p>
<p>0 整体</p>
<p>​    b  同步</p>
<p><img src="/2022/02/03/build-datawarehouse/13.JPG" alt></p>
<p>​    c .数据装载</p>
<p><img src="/2022/02/03/build-datawarehouse/14.JPG" alt></p>
<p>1.活动信息表</p>
<p>​    activity_info -&gt; ods_activity_info</p>
<p>​    a  建表</p>
<p>​        少了个“activity_desc”，多了”dt”</p>
<p><img src="/2022/02/03/build-datawarehouse/7.JPG" alt></p>
<p><img src="/2022/02/03/build-datawarehouse/6.JPG" alt></p>
<p>​    b  同步</p>
<p>​        首日，每日都是全量</p>
<p>​    c .数据装载</p>
<h2 id="4-DIM"><a href="#4-DIM" class="headerlink" title="4.DIM"></a>4.DIM</h2><p>hdfs（ods）-》hdfs（dim）</p>
<p>构建6张维度表</p>
<p>1 商品维度表</p>
<p>​    a 建表</p>
<p>​    b 分区</p>
<p>​        首日，每日都是全量</p>
<p>​    c 数据装载</p>
<p>2 优惠券维度表</p>
<p>3 活动维度表</p>
<p>4 地区维度表</p>
<p>​    b 分区</p>
<p>​        地区维度表数据相对稳定，变化概率较低，故无需每日装载，首日全量</p>
<p>5 时间维度表</p>
<p>​    b 分区</p>
<p>​        通常情况下，时间维度表的数据并不是来自于业务系统，而是手动写入，并且时间维度表数据具有可预见性，无须每日导入，一般首日可一次性导入一年的数据</p>
<p>​    c 数据装载</p>
<p>​            1）创建临时表tmp_dim_date_info</p>
<p>​            2）将数据文件上传到HFDS上临时表指定路径/warehouse/gmall/tmp/tmp_dim_date_info/</p>
<p>​            3）执行以下语句将其导入时间维度表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite table dim_date_info select * from tmp_dim_date_info;</span><br></pre></td></tr></table></figure>
<p>6 用户维度表</p>
<p>​    b 分区</p>
<p>​        拉链表</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1752848#">https://cloud.tencent.com/developer/article/1752848#</a></p>
<p><img src="/2022/02/03/build-datawarehouse/11.JPG" alt></p>
<p>​    c 数据装载</p>
<p><img src="/2022/02/03/build-datawarehouse/12.JPG" alt></p>
<h2 id="5-DWD"><a href="#5-DWD" class="headerlink" title="5.DWD"></a>5.DWD</h2><p>hdfs（ods）-》hdfs（dwd）</p>
<h4 id="1-用户行为日志"><a href="#1-用户行为日志" class="headerlink" title="1 用户行为日志"></a>1 用户行为日志</h4><p>0 日志数据拆解</p>
<p>ods_log由两部分构成，分别为页面日志和启动日志，拆解成5张表</p>
<p><img src="/2022/02/03/build-datawarehouse/1.JPG" alt></p>
<p>1 启动日志表</p>
<p>​    b 分区</p>
<p>​        首日，每日全量</p>
<p>​    c 数据装载</p>
<p><img src="/2022/02/03/build-datawarehouse/2.JPG" alt></p>
<p>2 页面日志表</p>
<p>3 动作日志表</p>
<p>4 曝光日志表</p>
<p>5 错误日志表</p>
<h4 id="2-业务数据-1"><a href="#2-业务数据-1" class="headerlink" title="2  业务数据"></a>2  业务数据</h4><p>1 评价事实表（事务型事实表）</p>
<p>​    b 分区</p>
<p><img src="/2022/02/03/build-datawarehouse/15.JPG" alt></p>
<p>​    c 数据装载</p>
<p><img src="/2022/02/03/build-datawarehouse/16.JPG" alt></p>
<p>​        首日，动态分区；每日，静态分区</p>
<p>2 订单明细事实表（事务型事实表）</p>
<p>3 退单事实表（事务型事实表）</p>
<p>4 加购事实表（周期型快照事实表）</p>
<p>​    b 分区</p>
<p><img src="/2022/02/03/build-datawarehouse/17.JPG" alt></p>
<p>​    c 数据加载</p>
<p><img src="/2022/02/03/build-datawarehouse/18.JPG" alt></p>
<p>5 收藏事实表（周期型快照事实表）</p>
<p>6 优惠券领用事实表（累积型快照事实表）</p>
<p>​    b 分区</p>
<p><img src="/2022/02/03/build-datawarehouse/19.JPG" alt></p>
<p>​    c 数据加载</p>
<p><img src="/2022/02/03/build-datawarehouse/20.JPG" alt></p>
<p>​        （1）首日</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite table dwd_coupon_use partition(dt)</span><br><span class="line">select</span><br><span class="line">    id,</span><br><span class="line">    coupon_id,</span><br><span class="line">    user_id,</span><br><span class="line">    order_id,</span><br><span class="line">    coupon_status,</span><br><span class="line">    get_time,</span><br><span class="line">    using_time,</span><br><span class="line">    used_time,</span><br><span class="line">    expire_time,</span><br><span class="line">    coalesce(date_format(used_time,&#x27;yyyy-MM-dd&#x27;),date_format(expire_time,&#x27;yyyy-MM-dd&#x27;),&#x27;9999-99-99&#x27;)</span><br><span class="line">from ods_coupon_use</span><br><span class="line">where dt=&#x27;2020-06-14&#x27;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>​        （2）每日</p>
<p><img src="/2022/02/03/build-datawarehouse/21.JPG" alt></p>
<p>7 支付事实表（累积型快照事实表）</p>
<p>8 退款事实表（累积型快照事实表）</p>
<p>9 订单事实表（累积型快照事实表）</p>
<h2 id="6-DWS"><a href="#6-DWS" class="headerlink" title="6.DWS"></a>6.DWS</h2><p>hdfs（dwd）-》hdfs（dws）</p>
<p>0 整体</p>
<p>​    b 分区</p>
<p>​        <img src="/2022/02/03/build-datawarehouse/22.JPG" alt></p>
<p>​    c 数据装载</p>
<p>​    <img src="/2022/02/03/build-datawarehouse/23.JPG" alt></p>
<p>1 访客主题</p>
<p>2 用户主题</p>
<p>3 商品主题</p>
<p>4 优惠券主题</p>
<p>5 活动主题</p>
<p>6 地区主题</p>
<h2 id="7-DWT"><a href="#7-DWT" class="headerlink" title="7.DWT"></a>7.DWT</h2><p>hdfs（dws）-》hdfs（DWT）</p>
<p>0 整体</p>
<p>c 数据装载</p>
<p><img src="/2022/02/03/build-datawarehouse/24.JPG" alt></p>
<p>只保留当天和前一天的分区，过时的需要清理掉i</p>
<p>1 访客主题</p>
<p>2 用户主题</p>
<p>3 商品主题</p>
<p>4 优惠券主题</p>
<p>5 活动主题</p>
<p>6 地区主题</p>
<h2 id="8-ADS"><a href="#8-ADS" class="headerlink" title="8.ADS"></a>8.ADS</h2><p>hdfs（DWT）-》hdfs（ADS）-》mysql</p>
<h4 id="1-访客主题"><a href="#1-访客主题" class="headerlink" title="1 访客主题"></a>1 访客主题</h4><p>1 访客统计</p>
<p> a 建表</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>指标</th>
<th>说明</th>
<th>对应字段</th>
</tr>
</thead>
<tbody>
<tr>
<td>访客数</td>
<td>统计访问人数</td>
<td>uv_count</td>
</tr>
<tr>
<td>页面停留时长</td>
<td>统计所有页面访问记录总时长，以秒为单位</td>
<td>duration_sec</td>
</tr>
<tr>
<td>平均页面停留时长</td>
<td>统计每个会话平均停留时长，以秒为单位</td>
<td>avg_duration_sec</td>
</tr>
<tr>
<td>页面浏览总数</td>
<td>统计所有页面访问记录总数</td>
<td>page_count</td>
</tr>
<tr>
<td>平均页面浏览数</td>
<td>统计每个会话平均浏览页面数</td>
<td>avg_page_count</td>
</tr>
<tr>
<td>会话总数</td>
<td>统计会话总数</td>
<td>sv_count</td>
</tr>
<tr>
<td>跳出数</td>
<td>统计只浏览一个页面的会话个数</td>
<td>bounce_count</td>
</tr>
<tr>
<td>跳出率</td>
<td>只有一个页面的会话的比例</td>
<td>bounce_rate</td>
</tr>
</tbody>
</table>
</div>
<p>b 分区</p>
<p>c 数据装载</p>
<p>第一步：对所有页面访问记录进行会话的划分。</p>
<p>第二步：统计每个会话的浏览时长和浏览页面数。</p>
<p>第三步：统计上述各指标。</p>
<p>2  路径分析</p>
<p>用户访问路径的可视化通常使用桑基图</p>
<p><img src="/2022/02/03/build-datawarehouse/4.jpg" alt></p>
<h4 id="2-用户主题"><a href="#2-用户主题" class="headerlink" title="2 用户主题"></a>2 用户主题</h4><h4 id="3-商品主题"><a href="#3-商品主题" class="headerlink" title="3 商品主题"></a>3 商品主题</h4><h4 id="4-订单主题"><a href="#4-订单主题" class="headerlink" title="4 订单主题"></a>4 订单主题</h4><h4 id="5-优惠券主题"><a href="#5-优惠券主题" class="headerlink" title="5 优惠券主题"></a>5 优惠券主题</h4><h4 id="6-活动主题"><a href="#6-活动主题" class="headerlink" title="6 活动主题"></a>6 活动主题</h4><h2 id="9-Azkaban全流程调度"><a href="#9-Azkaban全流程调度" class="headerlink" title="9.Azkaban全流程调度"></a>9.Azkaban全流程调度</h2><p><img src="/2022/02/03/build-datawarehouse/5.jpg" alt></p>
<p>就是将原来写的脚本文件串起来</p>
<p><img src="/2022/02/03/build-datawarehouse/8.JPG" alt></p>
<p><img src="/2022/02/03/build-datawarehouse/9.JPG" alt></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E4%BB%93/">数仓</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E4%BB%93/%E7%A6%BB%E7%BA%BF%E6%95%B0%E4%BB%93/">离线数仓</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%A6%BB%E7%BA%BF%E6%95%B0%E4%BB%93%E6%90%AD%E5%BB%BA%E4%BE%8B%E5%AD%90/">离线数仓搭建例子</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-02-01  <a class="commentCountImg" href="/2022/02/01/datawarehouse-develop-tool/#comment-container"><span class="display-none-class">5917c69f152af68a2496e01d23badccd</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="5917c69f152af68a2496e01d23badccd">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>fast  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/01/datawarehouse-develop-tool/">大数据工具</a></h1><div class="content"><h2 id="1-数据库管理工具"><a href="#1-数据库管理工具" class="headerlink" title="1 数据库管理工具"></a>1 数据库管理工具</h2><p><strong>Navicat</strong></p>
<p>破解</p>
<p><a target="_blank" rel="noopener" href="https://cdmana.com/2022/114/202204240555321952.html">https://cdmana.com/2022/114/202204240555321952.html</a></p>
<p><strong>DataGrip</strong></p>
<p>需要用到JDBC协议连接到Hive，故需要启动HiveServer2。</p>
<p><em>DataGrip</em> 版是由JetBrains 公司（就是那个出品Intellij IDEA 的公司）推出的数据库管理软件。</p>
<h2 id="2-数据库设计工具"><a href="#2-数据库设计工具" class="headerlink" title="2 数据库设计工具"></a>2 数据库设计工具</h2><p>EZDML:来辅助我们梳理复杂的业务表关系，效果如下</p>
<p><img src="/2022/02/01/datawarehouse-develop-tool/11.jpg" alt></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B7%A5%E5%85%B7/">大数据工具</a></div><hr></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-02-01  <a class="commentCountImg" href="/2022/02/01/sparkonhive/#comment-container"><span class="display-none-class">80da0a538cbcaa782b7431aac9d0aa1a</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="80da0a538cbcaa782b7431aac9d0aa1a">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>2 m  <i class="fas fa-pencil-alt"> </i>0.3 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/02/01/sparkonhive/">Spark on Hive &amp; Hive on Spark</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1624245">https://cloud.tencent.com/developer/article/1624245</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41290471/article/details/106203419">https://blog.csdn.net/weixin_41290471/article/details/106203419</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qingyunzong/p/8992664.html">https://www.cnblogs.com/qingyunzong/p/8992664.html</a></p>
<h2 id="1-Hive-on-Spark"><a href="#1-Hive-on-Spark" class="headerlink" title="1 Hive on Spark"></a>1 Hive on Spark</h2><p>就是将spark作为hive的计算引擎</p>
<p>Hive既作为存储元数据又负责SQL的解析优化，语法是HQL语法，执行引擎变成了Spark，Spark负责采用RDD执行。</p>
<h2 id="2-Spark-on-Hive"><a href="#2-Spark-on-Hive" class="headerlink" title="2 Spark on Hive"></a>2 Spark on Hive</h2><p>就是因为Spark自身没有元数据管理功能，所以使用Hive的Metastore服务作为元数据管理服务。计算由Spark执行。</p>
<p>Hive只作为存储元数据，Spark负责SQL解析优化，语法是Spark SQL语法，Spark负责采用RDD执行。</p>
<p>SparkSQL 的元数据的状态有两种：</p>
<p>1、in_memory,用完了元数据也就丢了</p>
<p>2、hive , 通过hive去保存的，也就是说，hive的元数据存在哪儿，它的元数据也就存在哪儿。换句话说，SparkSQL的数据仓库在建立在Hive之上实现的。我们要用SparkSQL去构建数据仓库的时候，必须依赖于Hive。</p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/spark/">spark</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/spark/%E5%8E%9F%E7%90%86/">原理</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/Spark-on-Hive-Hive-on-Spark/">Spark on Hive &amp; Hive on Spark</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-01-31  <a class="commentCountImg" href="/2022/01/31/hive/#comment-container"><span class="display-none-class">c7dac0c86dff64e9b12afbd2899b5254</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="c7dac0c86dff64e9b12afbd2899b5254">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>fast  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/31/hive/">hive</a></h1><div class="content"><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>1.FAILED: SemanticException Failed to get a spark session: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to create Spark client for Spark session</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41504585/article/details/108064512">https://blog.csdn.net/qq_41504585/article/details/108064512</a></p>
<h2 id="启动metastore"><a href="#启动metastore" class="headerlink" title="启动metastore"></a>启动metastore</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010670689/article/details/41576647">https://blog.csdn.net/u010670689/article/details/41576647</a></p>
<p>hive —service metastore 2&gt;&amp;1 &gt;&gt; /var/log.log &amp;</p>
<h2 id="启动hiveserver2"><a href="#启动hiveserver2" class="headerlink" title="启动hiveserver2"></a>启动hiveserver2</h2><p>hiveserver2</p>
<h2 id="连接方式"><a href="#连接方式" class="headerlink" title="连接方式"></a>连接方式</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41851454/article/details/79833306">https://blog.csdn.net/qq_41851454/article/details/79833306</a></p>
<p><a target="_blank" rel="noopener" href="https://www.shuzhiduo.com/A/RnJW4Z2r5q/">https://www.shuzhiduo.com/A/RnJW4Z2r5q/</a></p>
<p>1.cli</p>
<p>hive </p>
<p>2.beeline</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/97bbe79d88d2">https://www.jianshu.com/p/97bbe79d88d2</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/">hive</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/hive/">hive</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/hive/">hive</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-01-31  <a class="commentCountImg" href="/2022/01/31/sqoop/#comment-container"><span class="display-none-class">3a924bc585d1a517bf8962e764a4056c</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="3a924bc585d1a517bf8962e764a4056c">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>a minute  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/31/sqoop/">sqoop</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://www.yangshuaibin.com/detail/388673">https://www.yangshuaibin.com/detail/388673</a></p>
<h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>关系型数据库 &lt;&lt;——&gt;&gt; hdfs ，双向，用的mapreduce</p>
<p>sqoop的作用就是将关系型数据库中的某张表数据抽取到Hadoop的hdfs文件系统当中，底层运用的还是Map Reduce 。 它利用MapReduce加快数据传输速度，批处理方式进行数据传输。 也可以将HDFS上的文件数据导出到关系型数据库中的某张表。</p>
<h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44665283/article/details/120709047">https://blog.csdn.net/qq_44665283/article/details/120709047</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/sqoop/">sqoop</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/sqoop/">sqoop</a></div><hr></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-01-30  <a class="commentCountImg" href="/2022/01/30/table/#comment-container"><span class="display-none-class">d729f40b1bbc4abff367134be628d690</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d729f40b1bbc4abff367134be628d690">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>6 m  <i class="fas fa-pencil-alt"> </i>0.8 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/30/table/">各种表</a></h1><div class="content"><h2 id="1-分区表"><a href="#1-分区表" class="headerlink" title="1 分区表"></a>1 分区表</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1cdd3e3c5b3c">https://www.jianshu.com/p/1cdd3e3c5b3c</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/163f8375c0d6">https://www.jianshu.com/p/163f8375c0d6</a></p>
<p>1 mysql分区</p>
<p>RANGE分区：基于属于一个给定连续区间的列值，把多行分配给分区。</p>
<p>LIST分区：类似于按RANGE分区，区别在于LIST分区是基于列值匹配一个离散值集合中的某个值来进行选择。</p>
<p>HASH分区：基于用户定义的表达式的返回值来进行选择的分区，该表达式使用将要插入到表中的这些行的列值进行计算。这个函数可以包含MySQL 中有效的、产生非负整数值的任何表达式。</p>
<p>KEY分区：类似于按HASH分区，区别在于KEY分区只支持计算一列或多列，且MySQL 服务器提供其自身的哈希函数。必须有一列或多列包含整数值。</p>
<p>2 Hive中分区表</p>
<p>分两类：静态分区、动态分区；</p>
<p>Hive中没有复杂的分区类型（List,Range,Hash）</p>
<h2 id="2-内部表-amp-外部表"><a href="#2-内部表-amp-外部表" class="headerlink" title="2 内部表&amp;外部表"></a>2 内部表&amp;外部表</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qiaoyihang/p/6225151.html">https://www.cnblogs.com/qiaoyihang/p/6225151.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36743482/article/details/78393678">https://blog.csdn.net/qq_36743482/article/details/78393678</a></p>
<p>1 未被external修饰的是内部表（managed table），被external修饰的为外部表（external table）；</p>
<p>2 内部表数据由Hive自身管理，外部表数据由HDFS管理；</p>
<p>3 内部表数据存储的位置是hive.metastore.warehouse.dir（默认：/user/hive/warehouse），外部表数据的存储位置由自己制定（如果没有LOCATION，Hive将在HDFS上的/user/hive/warehouse文件夹下以外部表的表名创建一个文件夹，并将属于这个表的数据存放在这里）；<br>4 删除内部表会直接删除元数据（metadata）及存储数据；删除外部表仅仅会删除元数据，HDFS上的文件并不会被删除；<br>5 对内部表的修改会将修改直接同步给元数据，而对外部表的表结构和分区进行修改，则需要修复（MSCK REPAIR TABLE table_name;）</p>
<h2 id="3-临时表"><a href="#3-临时表" class="headerlink" title="3 临时表"></a>3 临时表</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/duanxz/p/3724120.html">https://www.cnblogs.com/duanxz/p/3724120.html</a></p>
<h2 id="4-字典表"><a href="#4-字典表" class="headerlink" title="4 字典表"></a>4 字典表</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jpfss/p/10418873.html">https://www.cnblogs.com/jpfss/p/10418873.html</a></p>
<h2 id="5-全量表，增量表、快照表、流水表"><a href="#5-全量表，增量表、快照表、流水表" class="headerlink" title="5 全量表，增量表、快照表、流水表"></a>5 全量表，增量表、快照表、流水表</h2><p>全量表：所有数据的最新状态</p>
<p>增量表：新增数据</p>
<p>快照表：</p>
<p><img src="/2022/01/30/table/12.JPG" alt></p>
<p>流水表： 对于表的每一个修改都会记录，可以用于反映实际记录的变更。</p>
<h2 id="6-切片表"><a href="#6-切片表" class="headerlink" title="6 切片表"></a>6 切片表</h2><p>切片表：切片表根据基础表，往往只反映某一个维度的相应数据。其表结构与基础表结构相同，但数据往往只有某一维度，或者某一个事实条件的数据</p>
<h2 id="7-拉链表"><a href="#7-拉链表" class="headerlink" title="7 拉链表"></a>7 拉链表</h2><p>1 定义</p>
<p><img src="/2022/01/30/table/1.JPG" alt></p>
<p>2 应用场景</p>
<p><img src="/2022/01/30/table/2.JPG" alt></p>
<p>3 分区</p>
<p><img src="/2022/01/30/table/4.JPG" alt></p>
<p>4 数据加载</p>
<p><img src="/2022/01/30/table/5.JPG" alt></p>
<p>1）首日装载</p>
<p>拉链表首日装载，需要进行初始化操作，具体工作为将截止到初始化当日的全部历史用户导入一次性导入到拉链表中。目前的ods_user_info 表的第一个分区，即2020-06-14 分区中就是全部的历史用户，故将该分区数据进行一定处理后导入拉链表的9999-99-99 分区即可。</p>
<p>2）每日装载</p>
<p><img src="/2022/01/30/table/6.JPG" alt></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E5%90%84%E7%A7%8D%E8%A1%A8/">各种表</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-01-30  <a class="commentCountImg" href="/2022/01/30/flume/#comment-container"><span class="display-none-class">c5d262561ca22248440008fdcfdfa345</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="c5d262561ca22248440008fdcfdfa345">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>5 m  <i class="fas fa-pencil-alt"> </i>0.8 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/30/flume/">flume</a></h1><div class="content"><h2 id="1-作用"><a href="#1-作用" class="headerlink" title="1.作用"></a>1.作用</h2><p>日志采集</p>
<p>Flume是流式日志采集工具，FLume提供对数据进行简单处理并且写到各种数据接收方（可定制）的能力，Flume提供从本地文件（spooling directory source）、实时日志（taildir、exec）、REST消息、Thift、Avro、Syslog、Kafka等数据源上收集数据的能力。</p>
<h2 id="2-Flume架构"><a href="#2-Flume架构" class="headerlink" title="2.Flume架构"></a>2.Flume架构</h2><p><a target="_blank" rel="noopener" href="https://jiandansuifeng.blog.csdn.net/article/details/118926483">https://jiandansuifeng.blog.csdn.net/article/details/118926483</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/9a5c682b0551">https://www.jianshu.com/p/9a5c682b0551</a></p>
<p>三大核心组件：</p>
<ul>
<li>Source:数据源</li>
<li>Channel:临时存储数据的管道</li>
<li>Sink: 目的地</li>
</ul>
<h2 id="3-拦截器-interceptor"><a href="#3-拦截器-interceptor" class="headerlink" title="3.拦截器(interceptor)"></a>3.拦截器(interceptor)</h2><p><a target="_blank" rel="noopener" href="https://blog.51cto.com/u_15241496/2869403">https://blog.51cto.com/u_15241496/2869403</a></p>
<p>拦截器是简单的插件式组件，设置在source和channel之间。source接收到的事件event，在写入channel之前，拦截器都可以进行转换或者删除这些事件。每个拦截器只处理同一个source接收到的事件。可以自定义拦截器。</p>
<p>1 jar包</p>
<p>2 将打包的jar放到XXX/flume/lib</p>
<p>3 配置文件</p>
<p>/opt/module/flume/conf</p>
<p>vim file-flume-kafka.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a1.sources.r1.interceptors = i1</span><br><span class="line">a1.sources.r1.interceptors.i1.type =</span><br><span class="line">com.atguigu.flume.interceptor.ETLInterceptor$Builder</span><br></pre></td></tr></table></figure>
<h2 id="4-为什么要集成Flume和Kafka"><a href="#4-为什么要集成Flume和Kafka" class="headerlink" title="4.为什么要集成Flume和Kafka"></a>4.为什么要集成Flume和Kafka</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37466640/article/details/103425555">https://blog.csdn.net/qq_37466640/article/details/103425555</a></p>
<h2 id="5-例子"><a href="#5-例子" class="headerlink" title="5.例子"></a>5.例子</h2><p><img src="/2022/01/30/flume/33.JPG" alt></p>
<h3 id="4-1-采集日志"><a href="#4-1-采集日志" class="headerlink" title="4.1 采集日志"></a>4.1 采集日志</h3><p><img src="/2022/01/30/flume/11.JPG" alt></p>
<p><strong>1）Source</strong></p>
<p>（1）Taildir Source相比Exec Source、Spooling Directory Source的优势</p>
<p>TailDir Source：断点续传、多目录。Flume1.6以前需要自己自定义Source记录每次读取文件位置，实现断点续传。不会丢数据，但是有可能会导致数据重复。</p>
<p>Exec Source可以实时搜集数据，但是在Flume不运行或者Shell命令出错的情况下，数据将会丢失。</p>
<p>Spooling Directory Source监控目录，支持断点续传。</p>
<p>（2）batchSize大小如何设置？</p>
<p>答：Event 1K左右时，500-1000合适（默认为100）</p>
<p><strong>2）Channel</strong></p>
<p>采用Kafka Channel，省去了Sink，提高了效率。KafkaChannel数据存储在Kafka里面，所以数据是存储在磁盘中。</p>
<p>注意在Flume1.7以前，Kafka Channel很少有人使用，因为发现parseAsFlumeEvent这个配置起不了作用。也就是无论parseAsFlumeEvent配置为true还是false，都会转为Flume Event。这样的话，造成的结果是，会始终都把Flume的headers中的信息混合着内容一起写入Kafka的消息中，这显然不是我所需要的，我只是需要把内容写入即可。</p>
<p><strong>3）Sink</strong></p>
<p>省去了Sink，提高了效率</p>
<p><strong>4）Interceptor</strong></p>
<p>ETLInterceptor</p>
<h3 id="4-2-消费数据"><a href="#4-2-消费数据" class="headerlink" title="4.2  消费数据"></a>4.2  消费数据</h3><p><img src="/2022/01/30/flume/22.JPG" alt></p>
<p><strong>1）Source</strong></p>
<p><strong>2）Channel</strong></p>
<p>MemoryChannel传输数据速度更快，但因为数据保存在JVM的堆内存中，Agent进程挂掉会导致数据丢失，适用于对数据质量要求不高的需求。FileChannel传输速度相对于Memory慢，但数据安全保障高，Agent进程挂掉也可以从失败中恢复数据。</p>
<p>金融类公司、对钱要求非常准确的公司通常会选择FileChannel</p>
<p>传输的是普通日志信息（京东内部一天丢100万-200万条，这是非常正常的），通常选择MemoryChannel。</p>
<p><strong>3）Sink</strong></p>
<p>HDFS Sink</p>
<p><strong>4）Interceptor</strong></p>
<p>TimeStampInterceptor</p>
<p>flume时间拦截器</p>
<p>获取日志中的实际时间</p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flume/">flume</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/flume/">flume</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-01-30  <a class="commentCountImg" href="/2022/01/30/kafka/#comment-container"><span class="display-none-class">5174def2cafb39e64e0976812f02b3a3</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="5174def2cafb39e64e0976812f02b3a3">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>a minute  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/30/kafka/">Kafka原理结构</a></h1><div class="content"><p>Apache Kafka® is an event streaming platform. What does that mean?</p>
<p>Kafka combines three key capabilities so you can implement  your use cases for event streaming end-to-end with a single battle-tested solution:</p>
<ol>
<li>To <strong>publish</strong> (write) and <strong>subscribe to</strong> (read) streams of events, including continuous import/export of your data from other systems.</li>
<li>To <strong>store</strong> streams of events durably and reliably for as long as you want.</li>
<li>To <strong>process</strong> streams of events as they occur or retrospectively.</li>
</ol>
<p>And all this functionality is provided in a distributed, highly scalable, elastic, fault-tolerant, and secure manner. Kafka can be deployed on bare-metal hardware, virtual machines, and containers, and on-premises as well as in the cloud. You can choose between self-managing your Kafka environments and using fully managed services offered by a variety of vendors.</p>
<p>详细原理见：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45366499/article/details/106943229">https://blog.csdn.net/weixin_45366499/article/details/106943229</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/Kafka/">Kafka</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/Kafka%E5%8E%9F%E7%90%86%E7%BB%93%E6%9E%84/">Kafka原理结构</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-01-30  <a class="commentCountImg" href="/2022/01/30/zookeeper/#comment-container"><span class="display-none-class">556ecffd1b36e7be52395549e0de52a3</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="556ecffd1b36e7be52395549e0de52a3">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>a minute  <i class="fas fa-pencil-alt"> </i>0.2 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/01/30/zookeeper/">ZooKeeper</a></h1><div class="content"><p>是一个分布式的，开放源码的<strong>分布式应用程序协调服务</strong>，是Google的Chubby一个开源的实现，是Hadoop和Hbase的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等。</p>
<h2 id="简单操作"><a href="#简单操作" class="headerlink" title="简单操作"></a>简单操作</h2><p>1 查看状态</p>
<p>bin/zkServer.sh status</p>
<p>有leader follower </p>
<p>shell脚本编写：start，stop，status</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>1 某个节点起不来</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_48268603/article/details/117687875">https://blog.csdn.net/qq_48268603/article/details/117687875</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012453843/article/details/70878117">https://blog.csdn.net/u012453843/article/details/70878117</a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://geek-docs.com/zookeeper/zookeeper-tutorial/zookeeper-profile.html#">https://geek-docs.com/zookeeper/zookeeper-tutorial/zookeeper-profile.html#</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/ZooKeeper/">ZooKeeper</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/ZooKeeper/">ZooKeeper</a></div><hr></div></article></div><!--!--><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/20/">Previous</a></div><div class="pagination-next"><a href="/page/22/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/20/">20</a></li><li><a class="pagination-link is-current" href="/page/21/">21</a></li><li><a class="pagination-link" href="/page/22/">22</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/40/">40</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars.githubusercontent.com/u/50144751?v=4" alt="Lavine Hu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Lavine Hu</p><p class="is-size-6 is-block">我能卖你生瓜蛋子？</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>杭州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">393</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">140</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">376</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hlw95" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hlw95"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="/null"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/18829272646@163.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Next" href="/null"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"From《"+data.from+"》</p><p>Provider-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-03T13:50:10.000Z">2023-05-03</time></p><p class="title"><a href="/2023/05/03/cpp-lang/">c++语法</a></p><p class="categories"><a href="/categories/c/">c++</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-16T13:01:22.000Z">2023-04-16</time></p><p class="title"><a href="/2023/04/16/cpp_init/">c++简介</a></p><p class="categories"><a href="/categories/c/">c++</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-05T15:23:33.000Z">2022-10-05</time></p><p class="title"><a href="/2022/10/05/python-multi-version/">python多版本兼容</a></p><p class="categories"><a href="/categories/python/">python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-04T15:42:29.000Z">2022-10-04</time></p><p class="title"><a href="/2022/10/04/python-multi-thread/">多线程</a></p><p class="categories"><a href="/categories/python/">python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-04T14:31:57.000Z">2022-10-04</time></p><p class="title"><a href="/2022/10/04/python-designmode/">设计模式</a></p><p class="categories"><a href="/categories/python/">python</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/GNN/"><span class="level-start"><span class="level-item">GNN</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/GNN/GCN/"><span class="level-start"><span class="level-item">GCN</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/GNN/GNN/"><span class="level-start"><span class="level-item">GNN</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/GNN/%E5%B0%8F%E5%B8%AE%E6%89%8B/"><span class="level-start"><span class="level-item">小帮手</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">68</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/NLP/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/NLP/PTM/"><span class="level-start"><span class="level-item">PTM</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/NLP/Prompt/"><span class="level-start"><span class="level-item">Prompt</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/NLP/Tokenization/"><span class="level-start"><span class="level-item">Tokenization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/NLP/%E4%BF%A1%E6%81%AF%E6%8A%BD%E5%8F%96/"><span class="level-start"><span class="level-item">信息抽取</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/04/"><span class="level-start"><span class="level-item">April 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/PTM/"><span class="tag">PTM</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E8%A1%A8%E7%A4%BA/"><span class="tag">文本表示</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E5%8C%B9%E9%85%8D/"><span class="tag">文本匹配</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%AC%E5%9B%9E/"><span class="tag">召回</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/"><span class="tag">文本分类</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E6%94%B9%E5%86%99/"><span class="tag">文本改写</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Atlas/"><span class="tag">Atlas</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AutoTokenizer/"><span class="tag">AutoTokenizer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Azkaban/"><span class="tag">Azkaban</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BertGCN/"><span class="tag">BertGCN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bert%E6%96%87%E6%9C%AC%E8%A1%A8%E7%A4%BA/"><span class="tag">Bert文本表示</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CDC%EF%BC%88Change-Data-Capture%EF%BC%89%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94/"><span class="tag">CDC（Change Data Capture）工具对比</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CRF%E5%92%8CHMM/"><span class="tag">CRF和HMM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ChineseBERT-Chinese-Pretraining-Enhanced-by-Glyph-and-Pinyin-Information/"><span class="tag">ChineseBERT Chinese Pretraining Enhanced by Glyph and Pinyin Information</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DAG/"><span class="tag">DAG</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DGL/"><span class="tag">DGL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DGL-notice/"><span class="tag">DGL notice</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DIEN/"><span class="tag">DIEN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DIN/"><span class="tag">DIN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DMR/"><span class="tag">DMR</span><span class="tag is-grey-lightest">1</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Lavine Hu</a><p class="size-small"><span>&copy; 2023 Lavine Hu</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2021/07/17 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('a0eb7de1c4dc4908943b','b466946cbbe843a4a6ef249eb54ae5956d2f91c3','hlw95','hlw95.github.io',false);})</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('a0eb7de1c4dc4908943b','b466946cbbe843a4a6ef249eb54ae5956d2f91c3','hlw95','hlw95.github.io',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"display":null,"superSample":2,"width":250,"height":500,"position":"right","hOffset":0,"vOffset":-20,"jsonPath":"/live2dw/assets/hijiki.model.json"},"mobile":{"show":true,"scale":0.5,"react":null,"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>