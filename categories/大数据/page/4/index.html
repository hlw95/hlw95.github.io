<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Category: 大数据 - Lavine Hu</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Lavine Hu"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lavine Hu"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Lavine Hu"><meta property="og:url" content="https://github.com/hlw95?tab=following"><meta property="og:site_name" content="Lavine Hu"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><meta property="article:author" content="Lavine Hu"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Lavine Hu","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Lavine Hu"},"description":""}</script><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Lavine Hu</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/message">留言</a></div><div class="navbar-end"><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">大数据</a></li></ul></nav></div></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-04-02  <a class="commentCountImg" href="/2022/04/02/hql-function/#comment-container"><span class="display-none-class">53fe8ed5e0553008897e15aeea410857</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="53fe8ed5e0553008897e15aeea410857">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>3 m  <i class="fas fa-pencil-alt"> </i>0.5 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/02/hql-function/">函数</a></h1><div class="content"><h2 id="1-系统函数"><a href="#1-系统函数" class="headerlink" title="1 系统函数"></a>1 系统函数</h2><p><a target="_blank" rel="noopener" href="https://www.studytime.xin/article/hive-knowledge-function.html">https://www.studytime.xin/article/hive-knowledge-function.html</a></p>
<p>1 get_json_object</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43412569/article/details/105290637">https://blog.csdn.net/weixin_43412569/article/details/105290637</a></p>
<p><img src="/2022/04/02/hql-function/1.JPG" alt></p>
<p>2 nvl</p>
<p>空值判断转换函数</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/a850661962/article/details/101209028">https://blog.csdn.net/a850661962/article/details/101209028</a></p>
<p>3 coalesce</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yilulvxing/article/details/86595725">https://blog.csdn.net/yilulvxing/article/details/86595725</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select coalesce(success_cnt,period,1) from tableA</span><br></pre></td></tr></table></figure>
<p>当success_cnt不为null，那么无论period是否为null，都将返回success_cnt的真实值（因为success_cnt是第一个参数），当success_cnt为null，而period不为null的时候，返回period的真实值。只有当success_cnt和period均为null的时候，将返回1。</p>
<p>4 collect_list和collect_set</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30230059/article/details/113324945">https://blog.csdn.net/weixin_30230059/article/details/113324945</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44104303/article/details/117551807">https://blog.csdn.net/qq_44104303/article/details/117551807</a></p>
<p>它们都是将分组中的某列转为一个数组返回，不同的是collect_list不去重而collect_set去重。</p>
<p>5 named_struct</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43597208/article/details/117554838">https://blog.csdn.net/weixin_43597208/article/details/117554838</a></p>
<p>做字段拼接</p>
<p>区别于struct，struct 是集合数据类型，一般用于建表，named_struct是字段拼接函数，一般用于查询</p>
<p>6 array_contains()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_contains(array，值)</span><br></pre></td></tr></table></figure>
<p>判断array中是否包含某个值，包含返回true，不包含返回false</p>
<p>7 cast</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/999176fa2730">https://www.jianshu.com/p/999176fa2730</a></p>
<p>显式的将一个类型的数据转换成另一个数据类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cast(字段名 as 转换的类型 )</span><br></pre></td></tr></table></figure>
<h2 id="2-用户自定义函数"><a href="#2-用户自定义函数" class="headerlink" title="2 用户自定义函数"></a>2 用户自定义函数</h2><p>UDF(User-Defined-Function)：单入单出<br>UDTF(User-Defined Table-Generating Functions)：单入多出<br>UDAF(User Defined Aggregation Function)：多入单出<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40579464/article/details/105903405">https://blog.csdn.net/qq_40579464/article/details/105903405</a></p>
<p>1.编写代码</p>
<p>jar不能随意编写，需要和hive对齐接口，可以借助工具import org.apache.hadoop.hive.ql.exec.UDF;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 public class classname extends UDF</span><br><span class="line">2 编写evalute</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/eyeofeagle/article/details/83904147">https://blog.csdn.net/eyeofeagle/article/details/83904147</a></p>
<p>2.打包<br>3.导入hive<br>复制到hdfs上<br>Hive安装目录的lib目录下<br>4.创建关联<br>add jar hdfs://localhost:9000/user/root/hiveudf.jar<br>create temporary function my_lower as ‘com.example.hive.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=udf&amp;spm=1001.2101.3001.7020">udf</a>.LowerCase’;<br>5.使用</p>
<p>hql udf的使用和普通内置函数一样，比如有udf1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select udf1（col1） from table1</span><br></pre></td></tr></table></figure>
<h2 id><a href="#" class="headerlink" title=" "></a> </h2></div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/">hive</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/hql/">hql</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/hql%E5%87%BD%E6%95%B0/">hql函数</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-04-02  <a class="commentCountImg" href="/2022/04/02/hql-loaddata/#comment-container"><span class="display-none-class">02cc0a152fe19584e1d6d82973ddd1ed</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="02cc0a152fe19584e1d6d82973ddd1ed">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>a minute  <i class="fas fa-pencil-alt"> </i>0.2 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/02/hql-loaddata/">加载数据</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bjlhx/p/6946422.html">https://www.cnblogs.com/bjlhx/p/6946422.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_49092046/article/details/109251015">https://blog.csdn.net/m0_49092046/article/details/109251015</a></p>
<h2 id="1-load"><a href="#1-load" class="headerlink" title="1 load"></a>1 load</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data [local] inpath ‘/opt/module/datas/student.txt’ [overwrite] | into table tabName [partition (partcol1=val1,…)];</span><br></pre></td></tr></table></figure>
<p>（1）load data:表示加载数据<br>（2）local:表示从本地加载数据到 hive 表；否则从 HDFS 加载数据到 hive 表<br>（3）inpath:表示加载数据的路径<br>（4）overwrite:表示覆盖表中已有数据，否则表示追加<br>（5）into table:表示加载到哪张表<br>（6）tabName:表示具体的表<br>（7）partition:表示上传到指定分区</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data inpath &#x27;/origin_data/gmall/log/topic_log/2020-06-14&#x27; into table ods_log partition(dt=&#x27;2020-06-14&#x27;)</span><br></pre></td></tr></table></figure>
<h2 id="2-INSERT"><a href="#2-INSERT" class="headerlink" title="2 INSERT"></a>2 INSERT</h2><p><a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/73775.html">https://help.aliyun.com/document_detail/73775.html</a></p>
<p>insert into 和insert overwrite</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">insert into table student  partition(month=&#x27;20201022&#x27;) values(1,&#x27;zhangsan&#x27;);</span><br><span class="line">2 </span><br><span class="line">insert overwrite table student partition(month=&#x27;20201023&#x27;)</span><br><span class="line">select id, name from student where month=&#x27;20201023&#x27;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/">hive</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/hql/">hql</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/hql%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE/">hql加载数据</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-04-02  <a class="commentCountImg" href="/2022/04/02/hql-build/#comment-container"><span class="display-none-class">df40401f8f6524c375dc1d53f7b3ebed</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="df40401f8f6524c375dc1d53f7b3ebed">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>7 m  <i class="fas fa-pencil-alt"> </i>1.0 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/02/hql-build/">建表</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4f60f3c923fe">https://www.jianshu.com/p/4f60f3c923fe</a></p>
<h2 id="0-CREATE-TABLE"><a href="#0-CREATE-TABLE" class="headerlink" title="0 CREATE  TABLE"></a>0 CREATE  TABLE</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Thomson617/article/details/86153924">https://blog.csdn.net/Thomson617/article/details/86153924</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTERNAL TABLE dim_sku_info (</span><br><span class="line">    `id` STRING COMMENT &#x27;商品id&#x27;,</span><br><span class="line">    `price` DECIMAL(16,2) COMMENT &#x27;商品价格&#x27;,</span><br><span class="line">    `sku_name` STRING COMMENT &#x27;商品名称&#x27;,</span><br><span class="line">    `sku_desc` STRING COMMENT &#x27;商品描述&#x27;,</span><br><span class="line">    `weight` DECIMAL(16,2) COMMENT &#x27;重量&#x27;,</span><br><span class="line">    `is_sale` BOOLEAN COMMENT &#x27;是否在售&#x27;,</span><br><span class="line">    `spu_id` STRING COMMENT &#x27;spu编号&#x27;,</span><br><span class="line">    `spu_name` STRING COMMENT &#x27;spu名称&#x27;,</span><br><span class="line">    `category3_id` STRING COMMENT &#x27;三级分类id&#x27;,</span><br><span class="line">    `category3_name` STRING COMMENT &#x27;三级分类名称&#x27;,</span><br><span class="line">    `category2_id` STRING COMMENT &#x27;二级分类id&#x27;,</span><br><span class="line">    `category2_name` STRING COMMENT &#x27;二级分类名称&#x27;,</span><br><span class="line">    `category1_id` STRING COMMENT &#x27;一级分类id&#x27;,</span><br><span class="line">    `category1_name` STRING COMMENT &#x27;一级分类名称&#x27;,</span><br><span class="line">    `tm_id` STRING COMMENT &#x27;品牌id&#x27;,</span><br><span class="line">    `tm_name` STRING COMMENT &#x27;品牌名称&#x27;,</span><br><span class="line">    `sku_attr_values` ARRAY&lt;STRUCT&lt;attr_id:STRING,value_id:STRING,attr_name:STRING,value_name:STRING&gt;&gt; COMMENT &#x27;平台属性&#x27;,</span><br><span class="line">    `sku_sale_attr_values` ARRAY&lt;STRUCT&lt;sale_attr_id:STRING,sale_attr_value_id:STRING,sale_attr_name:STRING,sale_attr_value_name:STRING&gt;&gt; COMMENT &#x27;销售属性&#x27;,</span><br><span class="line">    `create_time` STRING COMMENT &#x27;创建时间&#x27;</span><br><span class="line">) COMMENT &#x27;商品维度表&#x27;</span><br></pre></td></tr></table></figure>
<p>1  EXTERNAL</p>
<p>关键字可以让用户创建一个外部表，默认是内部表</p>
<p>2 字段的数据类型</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46941961/article/details/108551512">https://blog.csdn.net/weixin_46941961/article/details/108551512</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43215250/article/details/90034169">https://blog.csdn.net/weixin_43215250/article/details/90034169</a></p>
<p>集合数据类型：Array、Map和Struct</p>
<h2 id="1-分区"><a href="#1-分区" class="headerlink" title="1.分区"></a>1.分区</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5dbbaea8ff41">https://www.jianshu.com/p/5dbbaea8ff41</a></p>
<p>PARTITIONED BY (<code>dt</code> string)</p>
<p>0 分类</p>
<p>静态分区SP（static partition）<br>动态分区DP（dynamic partition）</p>
<p>静态分区与动态分区的主要区别在于静态分区是手动指定，而动态分区是通过数据来进行判断。</p>
<p>1 静态分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">--建表</span><br><span class="line">DROP TABLE IF EXISTS dwd_display_log;</span><br><span class="line">CREATE EXTERNAL TABLE dwd_display_log(</span><br><span class="line">    `area_code` STRING COMMENT &#x27;地区编码&#x27;,</span><br><span class="line">    `brand` STRING COMMENT &#x27;手机品牌&#x27;,</span><br><span class="line">    `channel` STRING COMMENT &#x27;渠道&#x27;,</span><br><span class="line">    `is_new` STRING COMMENT &#x27;是否首次启动&#x27;,</span><br><span class="line">    `model` STRING COMMENT &#x27;手机型号&#x27;,</span><br><span class="line">    `mid_id` STRING COMMENT &#x27;设备id&#x27;,</span><br><span class="line">    `os` STRING COMMENT &#x27;操作系统&#x27;,</span><br><span class="line">    `user_id` STRING COMMENT &#x27;会员id&#x27;,</span><br><span class="line">    `version_code` STRING COMMENT &#x27;app版本号&#x27;,</span><br><span class="line">    `during_time` BIGINT COMMENT &#x27;app版本号&#x27;,</span><br><span class="line">    `page_item` STRING COMMENT &#x27;目标id &#x27;,</span><br><span class="line">    `page_item_type` STRING COMMENT &#x27;目标类型&#x27;,</span><br><span class="line">    `last_page_id` STRING COMMENT &#x27;上页类型&#x27;,</span><br><span class="line">    `page_id` STRING COMMENT &#x27;页面ID &#x27;,</span><br><span class="line">    `source_type` STRING COMMENT &#x27;来源类型&#x27;,</span><br><span class="line">    `ts` BIGINT COMMENT &#x27;app版本号&#x27;,</span><br><span class="line">    `display_type` STRING COMMENT &#x27;曝光类型&#x27;,</span><br><span class="line">    `item` STRING COMMENT &#x27;曝光对象id &#x27;,</span><br><span class="line">    `item_type` STRING COMMENT &#x27;app版本号&#x27;,</span><br><span class="line">    `order` BIGINT COMMENT &#x27;曝光顺序&#x27;,</span><br><span class="line">    `pos_id` BIGINT COMMENT &#x27;曝光位置&#x27;</span><br><span class="line">) COMMENT &#x27;曝光日志表&#x27;</span><br><span class="line">PARTITIONED BY (`dt` STRING)</span><br><span class="line">STORED AS PARQUET</span><br><span class="line">LOCATION &#x27;/warehouse/gmall/dwd/dwd_display_log&#x27;</span><br><span class="line">TBLPROPERTIES(&#x27;parquet.compression&#x27;=&#x27;lzo&#x27;);</span><br><span class="line">--加载数据</span><br><span class="line">insert overwrite table dwd_display_log partition(dt=&#x27;2020-06-14&#x27;)</span><br><span class="line">select</span><br><span class="line">    get_json_object(line,&#x27;$.common.ar&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.ba&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.ch&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.is_new&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.md&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.mid&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.os&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.uid&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.common.vc&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.page.during_time&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.page.item&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.page.item_type&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.page.last_page_id&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.page.page_id&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.page.source_type&#x27;),</span><br><span class="line">    get_json_object(line,&#x27;$.ts&#x27;),</span><br><span class="line">    get_json_object(display,&#x27;$.display_type&#x27;),</span><br><span class="line">    get_json_object(display,&#x27;$.item&#x27;),</span><br><span class="line">    get_json_object(display,&#x27;$.item_type&#x27;),</span><br><span class="line">    get_json_object(display,&#x27;$.order&#x27;),</span><br><span class="line">    get_json_object(display,&#x27;$.pos_id&#x27;)</span><br><span class="line">from ods_log lateral view explode_json_array(get_json_object(line,&#x27;$.displays&#x27;)) tmp as display</span><br><span class="line">where dt=&#x27;2020-06-14&#x27;</span><br><span class="line">and get_json_object(line,&#x27;$.displays&#x27;) is not null;</span><br></pre></td></tr></table></figure>
<p>2 动态分区</p>
<p>注意分区字段dt数据来源于date_format(create_time,’yyyy-MM-dd’)</p>
<p>和静态分区比较，建表的时候没区别，加载数据有区别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">--建表</span><br><span class="line">DROP TABLE IF EXISTS dwd_comment_info;</span><br><span class="line">CREATE EXTERNAL TABLE dwd_comment_info(</span><br><span class="line">    `id` STRING COMMENT &#x27;编号&#x27;,</span><br><span class="line">    `user_id` STRING COMMENT &#x27;用户ID&#x27;,</span><br><span class="line">    `sku_id` STRING COMMENT &#x27;商品sku&#x27;,</span><br><span class="line">    `spu_id` STRING COMMENT &#x27;商品spu&#x27;,</span><br><span class="line">    `order_id` STRING COMMENT &#x27;订单ID&#x27;,</span><br><span class="line">    `appraise` STRING COMMENT &#x27;评价(好评、中评、差评、默认评价)&#x27;,</span><br><span class="line">    `create_time` STRING COMMENT &#x27;评价时间&#x27;</span><br><span class="line">) COMMENT &#x27;评价事实表&#x27;</span><br><span class="line">PARTITIONED BY (`dt` STRING)</span><br><span class="line">STORED AS PARQUET</span><br><span class="line">LOCATION &#x27;/warehouse/gmall/dwd/dwd_comment_info/&#x27;</span><br><span class="line">TBLPROPERTIES (&quot;parquet.compression&quot;=&quot;lzo&quot;);</span><br><span class="line">--加载数据</span><br><span class="line">insert overwrite table dwd_comment_info partition (dt)</span><br><span class="line">select</span><br><span class="line">    id,</span><br><span class="line">    user_id,</span><br><span class="line">    sku_id,</span><br><span class="line">    spu_id,</span><br><span class="line">    order_id,</span><br><span class="line">    appraise,</span><br><span class="line">    create_time,</span><br><span class="line">    date_format(create_time,&#x27;yyyy-MM-dd&#x27;)</span><br><span class="line">from ods_comment_info</span><br><span class="line">where dt=&#x27;2020-0</span><br></pre></td></tr></table></figure>
<h2 id="2-LOCATION"><a href="#2-LOCATION" class="headerlink" title="2 LOCATION"></a>2 LOCATION</h2><p>LOCATION ‘/warehouse/gmall/ods/ods_log’</p>
<p>指定数据在hdfs上的存储位置</p>
<h2 id="3-ROW-FORMAT"><a href="#3-ROW-FORMAT" class="headerlink" title="3 ROW FORMAT"></a>3 ROW FORMAT</h2><p><a target="_blank" rel="noopener" href="https://www.imooc.com/article/12213">https://www.imooc.com/article/12213</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/S_Running_snail/article/details/84258162">https://blog.csdn.net/S_Running_snail/article/details/84258162</a></p>
<p>指定数据切分格式</p>
<p>ROW FORMAT DELIMITED FIELDS TERMINATED BY ‘\t’</p>
<h2 id="4-STORED-AS"><a href="#4-STORED-AS" class="headerlink" title="4 STORED AS"></a>4 STORED AS</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ZZQHELLO2018/article/details/106175887">https://blog.csdn.net/ZZQHELLO2018/article/details/106175887</a></p>
<p>指定存储方式</p>
<p>行式存储：TEXTFILE 、SEQUENCEFILE   列式存储： ORC、PARQUET</p>
<h2 id="5-TBLPROPERTIES"><a href="#5-TBLPROPERTIES" class="headerlink" title="5 TBLPROPERTIES"></a>5 TBLPROPERTIES</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yangguosb/article/details/83651073">https://blog.csdn.net/yangguosb/article/details/83651073</a></p>
<p><a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateTableCreate/Drop/TruncateTable">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-CreateTableCreate/Drop/TruncateTable</a></p>
<p>TBLPROPERTIES是表的一些属性，HIVE内置了一部分属性，使用者也可以在创建表时进行自定义；</p>
<p>TBLPROPERTIES (“parquet.compression”=”lzo”); </p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/">hive</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/hql/">hql</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/hql%E5%BB%BA%E8%A1%A8/">hql建表</a></div><hr></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-04-02  <a class="commentCountImg" href="/2022/04/02/sql-crud/#comment-container"><span class="display-none-class">d39199a68fab1061c332ad4f55b68aa3</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d39199a68fab1061c332ad4f55b68aa3">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>fast  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/02/sql-crud/">sql增删改查</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Zhangxichao100/article/details/55099118">https://blog.csdn.net/Zhangxichao100/article/details/55099118</a></p>
<h2 id="1-增"><a href="#1-增" class="headerlink" title="1 增"></a>1 增</h2><p>1 insert</p>
<p>insert into table (姓名,性别,出生日期) values (‘王伟华’,’男’,’1983/6/15’)</p>
<p>insert into table (‘姓名’,’地址’,’电子邮件’)select name,address,email     from Strdents </p>
<p>2 SELECT INTO</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name</span><br><span class="line">INTO newtable</span><br><span class="line">FROM table1;</span><br></pre></td></tr></table></figure>
<h2 id="2-删"><a href="#2-删" class="headerlink" title="2 删"></a>2 删</h2><p>1 delete</p>
<p>删除数据某些数据</p>
<p>delete from table where name=’王伟华’</p>
<p>2 truncate  </p>
<p>删除整个表的数据</p>
<p>truncate table addressList</p>
<h2 id="3-改"><a href="#3-改" class="headerlink" title="3 改"></a>3 改</h2><p>1 update</p>
<p>update table set 年龄=18 where 姓名=’王伟华’ </p>
<h2 id="4-查"><a href="#4-查" class="headerlink" title="4 查"></a>4 查</h2><p> 1 select</p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BA%93/sql/">sql</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/sql%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/">sql增删改查</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-04-02  <a class="commentCountImg" href="/2022/04/02/datawarehouse-subject/#comment-container"><span class="display-none-class">a28976bfaf08ce75207231728c4da58b</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="a28976bfaf08ce75207231728c4da58b">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>a minute  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/04/02/datawarehouse-subject/">数仓主题和主题域</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_22473611/article/details/116702667">https://blog.csdn.net/qq_22473611/article/details/116702667</a></p>
<h2 id="1-主题域、主题、实体的关系"><a href="#1-主题域、主题、实体的关系" class="headerlink" title="1 主题域、主题、实体的关系"></a>1 主题域、主题、实体的关系</h2><p><img src="/2022/04/02/datawarehouse-subject/1.png" alt></p>
<p>主题域下面可以有多个主题，主题还可以划分成更多的子主题，主题和主题之间的建设可能会有交叉现象，而实体则是不可划分的最小单位</p>
<h2 id="2-主题域划分"><a href="#2-主题域划分" class="headerlink" title="2 主题域划分"></a>2 主题域划分</h2><p>1  按照业务系统划分</p>
<p><img src="/2022/04/02/datawarehouse-subject/2.png" alt></p>
<p>2 按照业务过程划分</p>
<p><img src="/2022/04/02/datawarehouse-subject/3.png" alt></p>
<p>3 按照部门划分</p>
<p><img src="/2022/04/02/datawarehouse-subject/4.png" alt></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/">数据仓库</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E4%BB%93/">数仓</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E4%BB%93/%E7%A6%BB%E7%BA%BF%E6%95%B0%E4%BB%93/">离线数仓</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E6%95%B0%E4%BB%93%E4%B8%BB%E9%A2%98%E5%92%8C%E4%B8%BB%E9%A2%98%E5%9F%9F/">数仓主题和主题域</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-03-30  <a class="commentCountImg" href="/2022/03/30/hive-metadatastore/#comment-container"><span class="display-none-class">0f904a84cec8445052159e2c3d7f15f7</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="0f904a84cec8445052159e2c3d7f15f7">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>fast  <i class="fas fa-pencil-alt"> </i>0.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/30/hive-metadatastore/">Hive MetaStore</a></h1><div class="content"><h2 id="1-描述"><a href="#1-描述" class="headerlink" title="1 描述"></a>1 描述</h2><p>Hive MetaStore - It is a central repository that stores all the structure information of various tables and partitions in the warehouse. It also includes metadata of column and its type information, the serializers and deserializers which is used to read and write data and the corresponding HDFS files where the data is stored.</p>
<h2 id="2-Hive的元数据存储-Metastore三种配置方式"><a href="#2-Hive的元数据存储-Metastore三种配置方式" class="headerlink" title="2 Hive的元数据存储(Metastore三种配置方式)"></a>2 Hive的元数据存储(Metastore三种配置方式)</h2><p>Embedded，Local，Remote</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/epitomizelu/article/details/117091656">https://blog.csdn.net/epitomizelu/article/details/117091656</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/473378621">https://zhuanlan.zhihu.com/p/473378621</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40990732/article/details/80914873">https://blog.csdn.net/qq_40990732/article/details/80914873</a></p>
<h2 id="3-Hive元数据库介绍"><a href="#3-Hive元数据库介绍" class="headerlink" title="3 Hive元数据库介绍"></a>3 Hive元数据库介绍</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/victorzzzz/article/details/81874674">https://blog.csdn.net/victorzzzz/article/details/81874674</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/">hive</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/hive/hive/">hive</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/Hive-MetaStore/">Hive MetaStore</a></div><hr></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-03-30  <a class="commentCountImg" href="/2022/03/30/database-split-table-base/#comment-container"><span class="display-none-class">fd0e9556b372c6d1ac552ef31696a052</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="fd0e9556b372c6d1ac552ef31696a052">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>fast  <i class="fas fa-pencil-alt"> </i>0.0 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/30/database-split-table-base/">分库分表</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/4487756131">https://www.zhihu.com/question/4487756131</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/137368446">https://zhuanlan.zhihu.com/p/137368446</a></p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/">分库分表</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-03-27  <a class="commentCountImg" href="/2022/03/27/flink-tableapi-sql/#comment-container"><span class="display-none-class">b27cb3fe4584b9c148474d6b82cfb6ea</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="b27cb3fe4584b9c148474d6b82cfb6ea">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>2 m  <i class="fas fa-pencil-alt"> </i>0.3 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/27/flink-tableapi-sql/">Table API和SQL</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45366499/article/details/115449175">https://blog.csdn.net/weixin_45366499/article/details/115449175</a></p>
<h2 id="0-原理"><a href="#0-原理" class="headerlink" title="0 原理"></a>0 原理</h2><p>1 动态表</p>
<p>flink中的表是动态表</p>
<p>静态表：hive，mysql等</p>
<p>动态表：不断更新</p>
<p>2 持续查询</p>
<p><img src="/2022/03/27/flink-tableapi-sql/2.jpg" alt></p>
<h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1 简介"></a>1 简介</h2><p>Apache Flink 有两种关系型 API 来做流批统一处理：Table API 和 SQL。</p>
<p>Table API 是用于 Scala 和 Java 语言的查询 API，它可以用一种非常直观的方式来 组合使用选取、过滤、join 等关系型算子。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Table maryClickTable = eventTable</span><br><span class="line">.where($(&quot;user&quot;).isEqual(&quot;alice&quot;))</span><br><span class="line">.select($(&quot;url&quot;), $(&quot;user&quot;));</span><br></pre></td></tr></table></figure>
<p>SQL 是基于 Apache Calcite 来实现的标准 SQL</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Table urlCountTable = tableEnv.sqlQuery(</span><br><span class="line">&quot;SELECT user, COUNT(url) FROM EventTable GROUP BY user&quot;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="2-框架"><a href="#2-框架" class="headerlink" title="2 框架"></a>2 框架</h2><p>表环境和流执行环境不同</p>
<p><img src="/2022/03/27/flink-tableapi-sql/1.JPG" alt></p>
<h2 id="3-流表相互转化"><a href="#3-流表相互转化" class="headerlink" title="3 流表相互转化"></a>3 流表相互转化</h2><p>stream 《——》table</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tableEnv表环境</span><br><span class="line">// 将数据流eventstream转换成表eventTable</span><br><span class="line">Table eventTable = tableEnv.fromDataStream(eventstream);</span><br><span class="line"></span><br><span class="line">// 将表visitTable转换成数据流，打印输出</span><br><span class="line">tableEnv.toDataStream(visitTable).print();</span><br></pre></td></tr></table></figure>
<h2 id="4-连接外部系统"><a href="#4-连接外部系统" class="headerlink" title="4 连接外部系统"></a>4 连接外部系统</h2><p>可以在创建表的时候用 WITH子句指定连接器connector</p>
<h2 id="5-客户端"><a href="#5-客户端" class="headerlink" title="5 客户端"></a>5 客户端</h2><p>./bin/sql client.sh</p>
<h2 id="6-时间属性"><a href="#6-时间属性" class="headerlink" title="6 时间属性"></a>6 时间属性</h2><p> 事件事件、处理事件</p>
<ol>
<li>在创建表的 DDL中定义</li>
<li>在数据流转换为表时定义</li>
</ol>
<h2 id="7-窗口"><a href="#7-窗口" class="headerlink" title="7 窗口"></a>7 窗口</h2></div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flink/">flink</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flink/%E4%BD%BF%E7%94%A8/">使用</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/Table-API%E5%92%8CSQL/">Table API和SQL</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-03-27  <a class="commentCountImg" href="/2022/03/27/fault-tolerance/#comment-container"><span class="display-none-class">baee227d95c9c484be013c0807f7d6e8</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="baee227d95c9c484be013c0807f7d6e8">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>2 m  <i class="fas fa-pencil-alt"> </i>0.2 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/27/fault-tolerance/">容错机制</a></h1><div class="content"><p>在分布式架构中，当某个节点出现故障，其他节点基本不受影响。这时只需要重启应用，恢复之前某个时间点的状态继续处理就可以了。这一切看似简单，可是在实时流处理中，我们不仅需要保证故障后能够重启继续运行，还要保证结果的正确性、故障恢复的速度、对处理性能的影响，这就需要在架构上做出更加精巧的设计。<br>在Flink中，有一套完整的容错机制（ fault tolerance）来保证故障后的恢复，其中最重要的就是检查点（ checkpoint）。在第九章中，我们已经介绍过检查点的基本概念和用途，接下来我 们就深入探讨一下检查点的原理和 Flink的容错机制。</p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flink/">flink</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flink/%E5%8E%9F%E7%90%86/">原理</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E5%AE%B9%E9%94%99%E6%9C%BA%E5%88%B6/">容错机制</a></div><hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-03-27  <a class="commentCountImg" href="/2022/03/27/flink-state-program/#comment-container"><span class="display-none-class">c990c8c17a34a297e953a4a6a18505df</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="c990c8c17a34a297e953a4a6a18505df">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>2 m  <i class="fas fa-pencil-alt"> </i>0.4 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/27/flink-state-program/">状态编程</a></h1><div class="content"><h2 id="0-状态管理机制"><a href="#0-状态管理机制" class="headerlink" title="0 状态管理机制"></a>0 状态管理机制</h2><h2 id="1-算子任务分类"><a href="#1-算子任务分类" class="headerlink" title="1 算子任务分类"></a>1 算子任务分类</h2><p>1 无状态</p>
<p><img src="/2022/03/27/flink-state-program/1.JPG" alt></p>
<p>2 有状态</p>
<p><img src="/2022/03/27/flink-state-program/2.JPG" alt></p>
<h2 id="2-状态分类"><a href="#2-状态分类" class="headerlink" title="2 状态分类"></a>2 状态分类</h2><p>Flink 有两种状态：托管状态（Managed State）和原始状态（Raw State）。一般情况使用托管状态，只有在托管状态无法实现特殊需求，才会使用原始转态，一般情况不使用。</p>
<p>托管状态分类：算子状态（Operator State）和按键分区状态（Keyed State）</p>
<p>1 按键分区状态</p>
<p><img src="/2022/03/27/flink-state-program/4.JPG" alt></p>
<p>2  算子状态</p>
<p><img src="/2022/03/27/flink-state-program/3.JPG" alt></p>
<p>3  广播状态 Broadcast State</p>
<p>   特殊的算子状态</p>
<h2 id="3-状态持久化"><a href="#3-状态持久化" class="headerlink" title="3 状态持久化"></a>3 状态持久化</h2><p><img src="/2022/03/27/flink-state-program/5.jpg" alt></p>
<p>对状态进行持久化（ persistence）保存，这样就可以在发生故障后进行重启恢复。</p>
<p>flink状态持久化方式：写入一个“检查点”（ checkpoint）或者保存点 savepoint<br>保存到外部存储系统中。具体的存储介质，一般是分布式文件系统（ distributed file system）。</p>
<h2 id="4-状态后端-State-Backends"><a href="#4-状态后端-State-Backends" class="headerlink" title="4 状态后端  State Backends"></a>4 状态后端  State Backends</h2><p>在Flink中，状态的存储、访问以及维护，都是由一个可插拔的组件决定的，这个组件就<br>叫作状态后端（ state backend）。状态后端主要负责两件事：一是本地的状态管理，二是将检查<br>点（ checkpoint）写入远程的 持久化存储。</p>
</div><div class="index-category-tag"><div class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/">基础组件</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flink/">flink</a><span> </span><a class="article-more button is-small link-muted index-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/flink/%E4%BD%BF%E7%94%A8/">使用</a></div>  <div class="level-item"><i class="fas fa-tags has-text-grey"> </i><a class="article-more button is-small link-muted index-tags" href="/tags/%E7%8A%B6%E6%80%81%E7%BC%96%E7%A8%8B/">状态编程</a></div><hr></div></article></div><!--!--><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/3/">Previous</a></div><div class="pagination-next"><a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">1</a></li><li><a class="pagination-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/2/">2</a></li><li><a class="pagination-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/3/">3</a></li><li><a class="pagination-link is-current" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/4/">4</a></li><li><a class="pagination-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/5/">5</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/page/14/">14</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars.githubusercontent.com/u/50144751?v=4" alt="Lavine Hu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Lavine Hu</p><p class="is-size-6 is-block">我能卖你生瓜蛋子？</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>杭州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">425</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">137</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">405</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hlw95" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hlw95"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="/null"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/18829272646@163.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Next" href="/null"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"From《"+data.from+"》</p><p>Provider-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-14T06:56:21.000Z">2024-04-14</time></p><p class="title"><a href="/2024/04/14/jar/">jar</a></p><p class="categories"><a href="/categories/java/">java</a> / <a href="/categories/java/java/">java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-14T06:56:07.000Z">2024-04-14</time></p><p class="title"><a href="/2024/04/14/java-compile/">java编译</a></p><p class="categories"><a href="/categories/java/">java</a> / <a href="/categories/java/java/">java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-14T06:29:22.000Z">2024-04-14</time></p><p class="title"><a href="/2024/04/14/gc/">gc</a></p><p class="categories"><a href="/categories/java/">java</a> / <a href="/categories/java/java/">java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-14T05:37:12.000Z">2024-04-14</time></p><p class="title"><a href="/2024/04/14/java-optimize/">java性能优化</a></p><p class="categories"><a href="/categories/java/">java</a> / <a href="/categories/java/java/">java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-14T05:36:18.000Z">2024-04-14</time></p><p class="title"><a href="/2024/04/14/java-mem/">java内存泄露</a></p><p class="categories"><a href="/categories/java/">java</a> / <a href="/categories/java/java/">java</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/GNN/"><span class="level-start"><span class="level-item">GNN</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/GNN/GCN/"><span class="level-start"><span class="level-item">GCN</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/GNN/GNN/"><span class="level-start"><span class="level-item">GNN</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/GNN/%E5%B0%8F%E5%B8%AE%E6%89%8B/"><span class="level-start"><span class="level-item">小帮手</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/LTR/"><span class="level-start"><span class="level-item">LTR</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/LTR/LTR/"><span class="level-start"><span class="level-item">LTR</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/LTR/listwise/"><span class="level-start"><span class="level-item">listwise</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/LTR/pairwise/"><span class="level-start"><span class="level-item">pairwise</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/LTR/pointwise/"><span class="level-start"><span class="level-item">pointwise</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/LTR/%E5%B0%8F%E5%B8%AE%E6%89%8B/"><span class="level-start"><span class="level-item">小帮手</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2024/04/"><span class="level-start"><span class="level-item">April 2024</span></span><span class="level-end"><span class="level-item tag">37</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/04/"><span class="level-start"><span class="level-item">April 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/PTM/"><span class="tag">PTM</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E8%A1%A8%E7%A4%BA/"><span class="tag">文本表示</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E5%8C%B9%E9%85%8D/"><span class="tag">文本匹配</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%98%E5%8C%96/"><span class="tag">优化</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%AC%E5%9B%9E/"><span class="tag">召回</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/"><span class="tag">文本分类</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%9C%AC%E6%94%B9%E5%86%99/"><span class="tag">文本改写</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Atlas/"><span class="tag">Atlas</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AutoTokenizer/"><span class="tag">AutoTokenizer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Azkaban/"><span class="tag">Azkaban</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BertGCN/"><span class="tag">BertGCN</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bert%E6%96%87%E6%9C%AC%E8%A1%A8%E7%A4%BA/"><span class="tag">Bert文本表示</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CDC%EF%BC%88Change-Data-Capture%EF%BC%89%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94/"><span class="tag">CDC（Change Data Capture）工具对比</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CRF%E5%92%8CHMM/"><span class="tag">CRF和HMM</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ChineseBERT-Chinese-Pretraining-Enhanced-by-Glyph-and-Pinyin-Information/"><span class="tag">ChineseBERT Chinese Pretraining Enhanced by Glyph and Pinyin Information</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DAG/"><span class="tag">DAG</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DGL/"><span class="tag">DGL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DGL-notice/"><span class="tag">DGL notice</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DIEN/"><span class="tag">DIEN</span><span class="tag is-grey-lightest">1</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Lavine Hu</a><p class="size-small"><span>&copy; 2024 Lavine Hu</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2021/07/17 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('a0eb7de1c4dc4908943b','b466946cbbe843a4a6ef249eb54ae5956d2f91c3','hlw95','hlw95.github.io',false);})</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('a0eb7de1c4dc4908943b','b466946cbbe843a4a6ef249eb54ae5956d2f91c3','hlw95','hlw95.github.io',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"display":null,"superSample":2,"width":250,"height":500,"position":"right","hOffset":0,"vOffset":-20,"jsonPath":"/live2dw/assets/hijiki.model.json"},"mobile":{"show":true,"scale":0.5,"react":null,"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>